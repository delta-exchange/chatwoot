FROM 685872830077.dkr.ecr.ap-northeast-1.amazonaws.com/base_chatwoot:chatwoot_v1

# Copy all directories that might contain forked changes
COPY app/ /app/app/
COPY lib/ /app/lib/
COPY config/ /app/config/
COPY db/ /app/db/
COPY public/ /app/public/
COPY enterprise/ /app/enterprise/

# Copy root-level files that might be customized
COPY Gemfile Gemfile.lock /app/
COPY package.json /app/
COPY Rakefile /app/

# Copy container initialization script
COPY container_init.sh /app/container_init.sh
RUN chmod +x /app/container_init.sh

EXPOSE 3001
CMD [ "/app/container_init.sh" ]
